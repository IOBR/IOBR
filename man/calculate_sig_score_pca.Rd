% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_sig_score.R
\name{calculate_sig_score_pca}
\alias{calculate_sig_score_pca}
\title{Calculate Signature Score Using PCA Method}
\usage{
calculate_sig_score_pca(
  pdata = NULL,
  eset,
  signature,
  mini_gene_count = 3,
  column_of_sample = "ID",
  adjust_eset = FALSE
)
}
\arguments{
\item{pdata}{Data frame containing phenotype data. If \code{NULL}, a data frame with
\code{Index} and \code{ID} columns is created from \code{eset} column names.
Default is \code{NULL}.}

\item{eset}{Matrix of normalized gene expression data (CPM, TPM, RPKM, FPKM, etc.)
with genes in rows and samples in columns.}

\item{signature}{List of gene signatures, where each element is a character vector
of gene names.}

\item{mini_gene_count}{Integer specifying the minimum number of genes required in
the expression set for a signature to be included. Default is 3.}

\item{column_of_sample}{Character string specifying the column in \code{pdata}
containing sample identifiers. Default is \code{"ID"}.}

\item{adjust_eset}{Logical indicating whether to remove features with missing values,
zero standard deviation, or infinite values. Default is \code{FALSE}.}
}
\value{
Tibble containing sample identifiers and signature scores (signatures in
  columns, samples in rows). Special combined scores (e.g., TMEscore_CIR) are
  calculated if corresponding signature pairs are present.
}
\description{
Computes signature scores for gene sets using Principal Component Analysis (PCA).
The first principal component is extracted from gene expression data for each
signature and used as the signature score.
}
\examples{
# Load TCGA-STAD expression data (raw count matrix)
data("eset_stad", package = "IOBR")
# Transform count data to TPM
eset <- count2tpm(eset_stad, idType = "ensembl")
# Calculate signature scores using PCA method
calculate_sig_score_pca(eset = eset, signature = signature_tme)
}
\author{
Dongqiang Zeng
}
