% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/anno_eset.R
\name{anno_eset}
\alias{anno_eset}
\title{Annotate Gene Expression Matrix and Remove Duplicated Genes}
\usage{
anno_eset(
  eset,
  annotation,
  symbol = "symbol",
  probe = "probe_id",
  method = "mean"
)
}
\arguments{
\item{eset}{Expression matrix or ExpressionSet object containing gene expression data.}

\item{annotation}{Data frame containing annotation information for probes. Built-in
options include \code{anno_hug133plus2}, \code{anno_rnaseq}, and \code{anno_illumina}.}

\item{symbol}{Character string specifying the column name in \code{annotation} that
represents gene symbols. Default is \code{"symbol"}.}

\item{probe}{Character string specifying the column name in \code{annotation} that
represents probe identifiers. Default is \code{"probe_id"}.}

\item{method}{Character string specifying the aggregation method for duplicate gene
symbols. Options are \code{"mean"}, \code{"sum"}, or \code{"sd"}. Default is
\code{"mean"}.}
}
\value{
Annotated and cleaned gene expression matrix with gene symbols as row names.
}
\description{
Annotates an expression matrix with gene symbols using provided annotation data,
filters out missing or invalid symbols, handles duplicate gene entries, and
removes uninformative rows. The function supports multiple aggregation methods
for resolving duplicate gene symbols.
}
\details{
The function performs the following operations:
\itemize{
  \item Filters probes with missing symbols or labeled as "NA_NA"
  \item Matches probes between expression set and annotation data
  \item Merges annotation with expression data
  \item Handles duplicate gene symbols using specified aggregation method
  \item Removes rows with all zeros, all NAs, or missing values in the first column
}
}
\examples{
# Annotate Affymetrix microarray data
data(eset_gse62254, package = "IOBR")
eset <- anno_eset(eset = eset_gse62254, annotation = anno_hug133plus2)

# Annotate RNA-seq data with Ensembl IDs
data(eset_stad, package = "IOBR")
eset <- anno_eset(eset = eset_stad, annotation = anno_grch38, probe = "id")
}
\author{
Dongqiang Zeng
}
