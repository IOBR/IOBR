% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sig_heatmap.R
\name{sig_heatmap}
\alias{sig_heatmap}
\title{Signature Heatmap with Optional Annotations}
\usage{
sig_heatmap(
  input,
  ID = "ID",
  features,
  group,
  condiction = NULL,
  id_condiction = "vars",
  col_condiction = "condiction",
  cols_condiction = NULL,
  scale = FALSE,
  palette = 2,
  palette_group = "jama",
  show_col = F,
  show_palettes = F,
  cols_group = NULL,
  show_plot = T,
  width = 8,
  height = NULL,
  size_col = 10,
  size_row = 8,
  angle_col = 90,
  column_title = NULL,
  row_title = NULL,
  show_heatmap_col_name = F,
  path = NULL,
  index = NULL
)
}
\arguments{
\item{input}{Data frame containing ID, grouping variable, and feature columns.}

\item{ID}{Character. Column name for sample identifier. Default "ID".}

\item{features}{Character vector. Feature (column) names to include.}

\item{group}{Character. Grouping variable column name.}

\item{condiction}{Data frame or NULL. Optional annotation table with variable-condition mapping.}

\item{id_condiction}{Character. Column name in condiction for feature IDs. Default "vars".}

\item{col_condiction}{Character. Column name in condiction for condition labels. Default "condiction".}

\item{cols_condiction}{Character vector. Colors for conditions.}

\item{scale}{Logical. Scale features by column. Default FALSE.}

\item{palette}{Integer or character. Palette index/name for heatmap colors. Default 2.}

\item{palette_group}{Character. Palette group for group colors. Default "jama".}

\item{show_col}{Logical. Whether to display color vector. Default FALSE.}

\item{show_palettes}{Logical. Whether to print palette options. Default FALSE.}

\item{cols_group}{Character vector. Custom colors for groups.}

\item{show_plot}{Logical. Whether to print the heatmap. Default TRUE.}

\item{width}{Numeric. Plot width in inches. Default 8.}

\item{height}{Numeric or NULL. Plot height (auto-calculated if NULL).}

\item{size_col}{Numeric. Font size for column labels. Default 10.}

\item{size_row}{Numeric. Font size for row labels. Default 8.}

\item{angle_col}{Numeric. Rotation angle for column labels. Default 90.}

\item{column_title}{Character or NULL. Column title.}

\item{row_title}{Character or NULL. Row title.}

\item{show_heatmap_col_name}{Logical. Show column names. Default FALSE.}

\item{path}{Character or NULL. Output directory.}

\item{index}{Integer or NULL. Index appended to filename.}
}
\value{
Invisibly returns path to saved plot; prints heatmap if show_plot = TRUE.
}
\description{
Generates a heatmap of selected features grouped by a categorical variable, with optional conditional (annotation) bars. Supports palette customization, scaling, size controls, and output saving.
}
\examples{
data("tcga_stad_sig", package = "IOBR")
data("tcga_stad_pdata", package = "IOBR")
input <- merge(tcga_stad_pdata, tcga_stad_sig, by = "ID")
feas <- grep("MCPcounter", colnames(input), value = TRUE)
sig_heatmap(input = input, features = feas, group = "subtype", scale = TRUE)

}
\author{
Dongqiang Zeng
}
