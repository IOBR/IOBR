% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sig_gsea.R
\name{sig_gsea}
\alias{sig_gsea}
\title{Perform Gene Set Enrichment Analysis (GSEA)}
\usage{
sig_gsea(
  deg,
  genesets = NULL,
  path = NULL,
  gene_symbol = "symbol",
  logfc = "log2FoldChange",
  org = "hsa",
  msigdb = TRUE,
  category = "H",
  subcategory = NULL,
  palette_bar = "jama",
  palette_gsea = 2,
  show_bar = 10,
  show_col = FALSE,
  show_plot = FALSE,
  show_gsea = 8,
  show_path_n = 20,
  plot_single_sig = FALSE,
  project = "custom_sig",
  minGSSize = 10,
  maxGSSize = 500,
  verbose = TRUE,
  seed = FALSE,
  fig.type = "pdf",
  print_bar = TRUE
)
}
\arguments{
\item{deg}{Data frame containing differential expression results with gene symbols
and log fold changes.}

\item{genesets}{List of custom gene sets for enrichment analysis. If \code{NULL},
MSigDB gene sets are used based on \code{org} and \code{category}. Default is
\code{NULL}.}

\item{path}{Character string specifying the directory path for saving results.
Default is \code{"1-GSEA-result"}.}

\item{gene_symbol}{Character string specifying the column name in \code{deg}
containing gene symbols. Default is \code{"symbol"}.}

\item{logfc}{Character string specifying the column name in \code{deg} containing
log fold change values. Default is \code{"log2FoldChange"}.}

\item{org}{Character string specifying the organism. Options are \code{"hsa"}
(Homo sapiens) or \code{"mus"} (Mus musculus). Default is \code{"hsa"}.}

\item{msigdb}{Logical indicating whether to use MSigDB gene sets. Default is
\code{TRUE}.}

\item{category}{Character string specifying the MSigDB category (e.g., \code{"H"}
for Hallmark, \code{"C2"} for curated gene sets). Default is \code{"H"}.}

\item{subcategory}{Character string specifying the MSigDB subcategory to filter
gene sets. Default is \code{NULL}.}

\item{palette_bar}{Character string or integer specifying the color palette for
bar plots. Default is \code{"jama"}.}

\item{palette_gsea}{Integer specifying the color palette for GSEA plots. Default
is 2.}

\item{show_bar}{Integer specifying the number of top enriched gene sets to display
in the bar plot. Default is 10.}

\item{show_col}{Logical indicating whether to display color names in the bar plot.
Default is \code{FALSE}.}

\item{show_plot}{Logical indicating whether to display GSEA enrichment plots.
Default is \code{FALSE}.}

\item{show_gsea}{Integer specifying the number of top significant gene sets for
which to generate GSEA plots. Default is 8.}

\item{show_path_n}{Integer specifying the number of pathways to display in GSEA
plots. Default is 20.}

\item{plot_single_sig}{Logical indicating whether to generate separate plots for
each significant gene set. Default is \code{TRUE}.}

\item{project}{Character string specifying the project name for output files.
Default is \code{"custom_sig"}.}

\item{minGSSize}{Integer specifying the minimum gene set size for analysis.
Default is 10.}

\item{maxGSSize}{Integer specifying the maximum gene set size for analysis.
Default is 500.}

\item{verbose}{Logical indicating whether to display progress messages. Default
is \code{TRUE}.}

\item{seed}{Logical indicating whether to set a random seed for reproducibility.
Default is \code{FALSE}.}

\item{fig.type}{Character string specifying the file format for saving plots
(e.g., \code{"pdf"}, \code{"png"}). Default is \code{"pdf"}.}

\item{print_bar}{Logical indicating whether to save and print the bar plot.
Default is \code{TRUE}.}
}
\value{
List containing:
\itemize{
  \item \code{up}: Data frame of up-regulated enriched gene sets
  \item \code{down}: Data frame of down-regulated enriched gene sets
  \item \code{gsea_result}: Complete GSEA result object
  \item \code{gsea_plots}: List of GSEA enrichment plots (if generated)
}
}
\description{
Conducts Gene Set Enrichment Analysis to identify significantly enriched gene sets
from differential gene expression data. Supports MSigDB gene sets or custom gene
signatures, and generates comprehensive visualizations and statistical results.
}
\examples{
# Load example data
data("eset_stad", package = "IOBR")
data("stad_group", package = "IOBR")
# Perform differential expression analysis
deg <- iobr_deg(eset = eset_stad, pdata = stad_group, group_id = "subtype",
                pdata_id = "ID", array = FALSE, method = "DESeq2",
                contrast = c("EBV", "GS"), path = "STAD")
# Run GSEA with custom gene sets
res <- sig_gsea(deg = deg, genesets = signature_tme)
}
\author{
Dongqiang Zeng
}
